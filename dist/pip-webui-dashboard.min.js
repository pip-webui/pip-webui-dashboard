!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(e.pip||(e.pip={})).dashboard=t()}}(function(){return function t(e,i,o){function n(r,s){if(!i[r]){if(!e[r]){var a="function"==typeof require&&require;if(!s&&a)return a(r,!0);if(l)return l(r,!0);var p=new Error("Cannot find module '"+r+"'");throw p.code="MODULE_NOT_FOUND",p}var c=i[r]={exports:{}};e[r][0].call(c.exports,function(t){var i=e[r][1][t];return n(i?i:t)},c,c.exports,t,e,i,o)}return i[r].exports}for(var l="function"==typeof require&&require,r=0;r<o.length;r++)n(o[r]);return n}({1:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t}();i.AddTileDialog=o;var n=function(){function t(t,e,i,o){this.activeGroupIndex=e,this.$mdDialog=o,this.totalTiles=0,this.activeGroupIndex=_.isNumber(e)?e:-1,this.defaultTiles=_.cloneDeep(i),this.groups=_.map(t,function(t){return t.title})}return t.prototype.add=function(){this.$mdDialog.hide({groupIndex:this.activeGroupIndex,widgets:this.defaultTiles})},t.prototype.cancel=function(){this.$mdDialog.cancel()},t.prototype.encrease=function(t,e){var i=this.defaultTiles[t][e];i.amount++,this.totalTiles++},t.prototype.decrease=function(t,e){var i=this.defaultTiles[t][e];i.amount=i.amount?i.amount-1:0,this.totalTiles=this.totalTiles?this.totalTiles-1:0},t}();i.AddTileDialogController=n},{}],2:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t("./AddTileDialogController"),n=function(t){var e=t.has("pipTranslateProvider")?t.get("pipTranslateProvider"):null;e&&(e.setTranslations("en",{DASHBOARD_ADD_TILE_DIALOG_TITLE:"Add component",DASHBOARD_ADD_TILE_DIALOG_USE_HOT_KEYS:'Use "Enter" or "+" buttons on keyboard to encrease and "Delete" or "-" to decrease tiles amount',DASHBOARD_ADD_TILE_DIALOG_CREATE_NEW_GROUP:"Create new group"}),e.setTranslations("ru",{DASHBOARD_ADD_TILE_DIALOG_TITLE:"Добавить компонент",DASHBOARD_ADD_TILE_DIALOG_USE_HOT_KEYS:'Используйте "Enter" или "+" клавиши на клавиатуре чтобы увеличить и "Delete" or "-" чтобы уменшить количество тайлов',DASHBOARD_ADD_TILE_DIALOG_CREATE_NEW_GROUP:"Создать новую группу"}))};n.$inject=["$injector"];var l=function(){function t(t,e){this.widgetList=t,this.$mdDialog=e}return t.prototype.show=function(t,e){var i=this;return this.$mdDialog.show({templateUrl:"add_tile_dialog/AddTile.html",bindToController:!0,controller:o.AddTileDialogController,controllerAs:"dialogCtrl",clickOutsideToClose:!0,resolve:{groups:function(){return t},activeGroupIndex:function(){return e},widgetList:function(){return i.widgetList}}})},t}(),r=function(){function t(){this._widgetList=null,this.configWidgetList=function(t){this._widgetList=t}}return t.prototype.$get=["$mdDialog",function(t){"ngInject";return null==this._service&&(this._service=new l(this._widgetList,t)),this._service}],t}();angular.module("pipAddDashboardTileDialog").config(n).provider("pipAddTileDialog",r)},{"./AddTileDialogController":1}],3:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipAddDashboardTileDialog",["ngMaterial"]),t("./AddTileDialogController"),t("./AddTileProvider")},{"./AddTileDialogController":1,"./AddTileProvider":2}],4:[function(t,e,i){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=t("../menu_tile/MenuTileService"),l=function(t){function e(e){var i=t.call(this)||this;return i.pipTileConfigDialogService=e,i.options&&(i.menu=i.options.menu?_.union(i.menu,i.options.menu):i.menu,i.menu.push({title:"Configurate",click:function(){i.onConfigClick()}}),i.options.date=i.options.date||new Date,i.color=i.options.color||"blue"),i}return o(e,t),e.prototype.onConfigClick=function(){var t=this;this.pipTileConfigDialogService.show({dialogClass:"pip-calendar-config",locals:{color:this.color,size:this.options.size,date:this.options.date},extensionUrl:"calendar_tile/ConfigDialogExtension.html"},function(e){t.changeSize(e.size),t.color=e.color,t.options.color=e.color,t.options.date=e.date})},e}(n.MenuTileService),r={bindings:{options:"=pipOptions"},controller:l,templateUrl:"calendar_tile/CalendarTile.html"};angular.module("pipDashboard").component("pipCalendarTile",r)},{"../menu_tile/MenuTileService":17}],5:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t}();i.DashboardTile=o},{}],6:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t}();o.all=["purple","green","gray","orange","blue"];var n=function(){function t(){}return t}();n.all=[{name:"DASHBOARD_TILE_CONFIG_DIALOG_SIZE_SMALL",id:"11"},{name:"DASHBOARD_TILE_CONFIG_DIALOG_SIZE_WIDE",id:"21"},{name:"DASHBOARD_TILE_CONFIG_DIALOG_SIZE_LARGE",id:"22"}];var l=function(){function t(t,e,i){"ngInject";var l=this;this.params=t,this.extensionUrl=e,this.$mdDialog=i,this.colors=o.all,this.sizes=n.all,this.sizeId=n.all[0].id,angular.extend(this,this.params),this.sizeId=""+this.params.size.colSpan+this.params.size.rowSpan,this.onCancel=function(){l.$mdDialog.cancel()}}return t.$inject=["params","extensionUrl","$mdDialog"],t.prototype.onApply=function(t){this.size.sizeX=Number(this.sizeId.substr(0,1)),this.size.sizeY=Number(this.sizeId.substr(1,1)),this.$mdDialog.hide(t)},t}();i.TileConfigDialogController=l},{}],7:[function(t,e,i){var o={pipExtensionUrl:"<",pipDialogScope:"<",pipApply:"&"},n=(function(){function t(){}return t}(),function(){function t(t,e,i,o,n){this.$templateRequest=t,this.$compile=e,this.$scope=i,this.$element=o,this.$attrs=n}return t.prototype.$onChanges=function(t){var e=this;t.pipDialogScope&&(delete t.pipDialogScope.currentValue.$scope,angular.extend(this,t.pipDialogScope.currentValue)),t.pipExtensionUrl&&t.pipExtensionUrl.currentValue&&this.$templateRequest(t.pipExtensionUrl.currentValue,!1).then(function(t){e.$element.find("pip-extension-point").replaceWith(e.$compile(t)(e.$scope))})},t.prototype.onApply=function(){this.pipApply({updatedData:this})},t}()),l={templateUrl:"config_tile_dialog/ConfigDialogExtendComponent.html",controller:n,bindings:o};angular.module("pipConfigDashboardTileDialog").component("pipTileConfigExtendComponent",l)},{}],8:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t("./ConfigDialogController"),n=function(t){var e=t.has("pipTranslateProvider")?t.get("pipTranslateProvider"):null;e&&(e.setTranslations("en",{DASHBOARD_TILE_CONFIG_DIALOG_TITLE:"Edit tile",DASHBOARD_TILE_CONFIG_DIALOG_SIZE_SMALL:"Small",DASHBOARD_TILE_CONFIG_DIALOG_SIZE_WIDE:"Wide",DASHBOARD_TILE_CONFIG_DIALOG_SIZE_LARGE:"Large"}),e.setTranslations("ru",{DASHBOARD_TILE_CONFIG_DIALOG_TITLE:"Изменить виджет",DASHBOARD_TILE_CONFIG_DIALOG_SIZE_SMALL:"Мален.",DASHBOARD_TILE_CONFIG_DIALOG_SIZE_WIDE:"Широкий",DASHBOARD_TILE_CONFIG_DIALOG_SIZE_LARGE:"Большой"}))};n.$inject=["$injector"];var l=function(){function t(t){this.$mdDialog=t}return t.$inject=["$mdDialog"],t.prototype.show=function(t,e,i){this.$mdDialog.show({targetEvent:t.event,templateUrl:t.templateUrl||"dialogs/tile_config/ConfigDialog.html",controller:o.TileConfigDialogController,bindToController:!0,controllerAs:"vm",locals:{extensionUrl:t.extensionUrl,params:t.locals},clickOutsideToClose:!0}).then(function(t){e&&e(t)},function(){i&&i()})},t}();angular.module("pipConfigDashboardTileDialog").config(n).service("pipTileConfigDialogService",l)},{"./ConfigDialogController":6}],9:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipConfigDashboardTileDialog",["ngMaterial"]),t("./ConfigDialogController"),t("./ConfigDialogService"),t("./ConfigDialogExtendComponent")},{"./ConfigDialogController":6,"./ConfigDialogExtendComponent":7,"./ConfigDialogService":8}],10:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){var e=t.has("pipTranslateProvider")?t.get("pipTranslateProvider"):null;e&&(e.setTranslations("en",{DROP_TO_CREATE_NEW_GROUP:"Drop here to create new group"}),e.setTranslations("ru",{DROP_TO_CREATE_NEW_GROUP:"Перетащите сюда для создания новой группы"}))};o.$inject=["$injector"];var n=function(t){t.configWidgetList([[{title:"Event",icon:"document",name:"event",amount:0},{title:"Position",icon:"location",name:"position",amount:0}],[{title:"Calendar",icon:"date",name:"calendar",amount:0},{title:"Sticky Notes",icon:"note-take",name:"notes",amount:0},{title:"Statistics",icon:"tr-statistics",name:"statistics",amount:0}]])};n.$inject=["pipAddTileDialogProvider"];var l=(function(){function t(){}return t}(),{tileWidth:150,tileHeight:150,gutter:10,inline:!1}),r=function(){function t(t,e,i,o,n,r,s,a){var p=this;this.$rootScope=e,this.$attrs=i,this.$element=o,this.$timeout=n,this.$interpolate=r,this.pipAddTileDialog=s,this.pipTileTemplate=a,this.defaultGroupMenuActions=[{title:"Add Component",callback:function(t){p.addComponent(t)}},{title:"Remove",callback:function(t){p.removeGroup(t)}},{title:"Configurate",callback:function(t){console.log("configurate group with index:",t)}}],this._includeTpl='<pip-{{ type }}-tile group="groupIndex" index="index"pip-options="$parent.$ctrl.groupedWidgets[groupIndex][\'source\'][index].opts"></pip-{{ type }}-tile>',this.groupMenuActions=this.defaultGroupMenuActions,this.removeGroup=function(t){console.log("removeGroup",t),p.groupedWidgets.splice(t,1)},o.addClass("pip-scroll"),this.draggableGridOptions=this.gridOptions||l,this.draggableGridOptions.inline===!0&&o.addClass("inline-grid"),this.groupAdditionalActions&&angular.extend(this.groupMenuActions,this.groupAdditionalActions),this.widgetsContext=t,this.compileWidgets(),this.$timeout(function(){p.$element.addClass("visible")},700)}return t.prototype.compileWidgets=function(){var t=this;_.each(this.groupedWidgets,function(e,i){e.removedWidgets=e.removedWidgets||[],e.source=e.source.map(function(e,o){return e.size=e.size||{colSpan:1,rowSpan:1},e.index=o,e.groupIndex=i,e.menu=e.menu||{},angular.extend(e.menu,[{title:"Remove",click:function(e,i,o){t.removeWidget(e,i,o)}}]),{opts:e,template:t.pipTileTemplate.getTemplate(e,t._includeTpl)}})})},t.prototype.addComponent=function(t){var e=this;this.pipAddTileDialog.show(this.groupedWidgets,t).then(function(t){var i;t&&(i=t.groupIndex!==-1?e.groupedWidgets[t.groupIndex]:{title:"New group",source:[]},e.addWidgets(i.source,t.widgets),t.groupIndex===-1&&e.groupedWidgets.push(i),e.compileWidgets())})},t.prototype.addWidgets=function(t,e){e.forEach(function(e){e.forEach(function(e){e.amount&&Array.apply(null,Array(e.amount)).forEach(function(){t.push({type:e.name})})})})},t.prototype.removeWidget=function(t,e,i){var o=this;this.groupedWidgets[e.options.groupIndex].removedWidgets=[],this.groupedWidgets[e.options.groupIndex].removedWidgets.push(e.options.index),this.groupedWidgets[e.options.groupIndex].source.splice(e.options.index,1),this.$timeout(function(){o.groupedWidgets[e.options.groupIndex].removedWidgets=[]})},t}(),s={bindings:{gridOptions:"=pipGridOptions",groupAdditionalActions:"=pipGroupActions",groupedWidgets:"=pipGroups"},controller:r,templateUrl:"dashboard/Dashboard.html"};angular.module("pipDashboard").config(n).config(o).component("pipDashboard",s)},{}],11:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t("./DraggableTileService"),n=t("../tile_group/TileGroupService");i.DEFAULT_TILE_WIDTH=150,i.DEFAULT_TILE_HEIGHT=150,i.UPDATE_GROUPS_EVENT="pipUpdateDashboardGroupsConfig";var l=2,r={tileWidth:i.DEFAULT_TILE_WIDTH,tileHeight:i.DEFAULT_TILE_HEIGHT,gutter:20,container:"pip-draggable-grid:first-of-type",activeDropzoneClass:"dropzone-active",groupContaninerSelector:".pip-draggable-group:not(.fict-group)"},s=function(){function t(t,e,i,n,l,s,a,p){var c=this;this.$scope=t,this.$rootScope=e,this.$compile=i,this.$timeout=n,this.$element=l,this.sourceDropZoneElem=null,this.isSameDropzone=!0,this.tileGroups=null,this.opts=_.merge({mobileBreakpoint:p.breakpoints.xs},r,this.options),this.groups=this.tilesTemplates.map(function(t,e){return{title:t.title,editingName:!1,index:e,source:t.source.map(function(t){var e=c.createTileScope(t);return o.IDragTileConstructor(o.DragTileService,{tpl:i(t.template)(e),options:t.opts,size:t.opts.size})})}}),t.$watch("$ctrl.tilesTemplates",function(t){c.watch(t)},!0),this.initialize(),$(window).on("resize",_.debounce(function(){c.availableWidth=c.getContainerWidth(),c.availableColumns=c.getAvailableColumns(c.availableWidth),c.tileGroups.forEach(function(t){t.setAvailableColumns(c.availableColumns).generateGrid(c.getSingleTileWidthForMobile(c.availableWidth)).setTilesDimensions().calcContainerHeight()})},50))}return t.prototype.$postLink=function(){this.$container=this.$element},t.prototype.watch=function(t){var e=this,i=this.groups,o=null;if(t.length>i.length)return void this.addGroup(t[t.length-1]);if(t.length<i.length)return void this.removeGroups(t);for(var n=0;n<t.length;n++){var l=i[n].source.length-t[n].source.length;if(l||t[n].removedWidgets&&t[n].removedWidgets.length>0){if(o=n,l<0){var r=t[o].source.slice(l);_.each(r,function(t){console.log("tile",t)}),this.addTilesIntoGroup(r,this.tileGroups[o],this.groupsContainers[o]),this.$timeout(function(){e.updateTilesGroups()})}else this.removeTiles(this.tileGroups[o],t[o].removedWidgets,this.groupsContainers[o]),this.updateTilesOptions(t),this.$timeout(function(){e.updateTilesGroups()});return}}t&&this.tileGroups&&(this.updateTilesOptions(t),this.$timeout(function(){e.updateTilesGroups()}))},t.prototype.onTitleClick=function(t,e){t.editingName||(t.oldTitle=_.clone(t.title),t.editingName=!0,this.$timeout(function(){$(e.currentTarget.children[0]).focus()}))},t.prototype.cancelEditing=function(t){t.title=t.oldTitle},t.prototype.onBlurTitleInput=function(t){var e=this;this.$timeout(function(){t.editingName=!1,e.$rootScope.$broadcast(i.UPDATE_GROUPS_EVENT,e.groups),e.tilesTemplates[t.index].title=t.title},100)},t.prototype.onKyepressTitleInput=function(t,e){13===e.keyCode&&this.onBlurTitleInput(t)},t.prototype.updateTilesTemplates=function(t,e){switch(t){case"addGroup":this.groups.length!==this.tilesTemplates.length&&this.tilesTemplates.push(e);break;case"moveTile":var i={fromIndex:e.from.elem.attributes["data-group-id"].value,toIndex:e.to.elem.attributes["data-group-id"].value,tileOptions:e.tile.opts.options,fromTileIndex:e.tile.opts.options.index},o=i.fromIndex,n=i.toIndex,l=i.tileOptions,r=i.fromTileIndex;this.tilesTemplates[o].source.splice(r,1),this.tilesTemplates[n].source.push({opts:l}),this.reIndexTiles(e.from.elem),this.reIndexTiles(e.to.elem)}},t.prototype.createTileScope=function(t){var e=this.$rootScope.$new(!1,this.tilesContext);return e.index=void 0==t.opts.index?t.opts.options.index:t.opts.index,e.groupIndex=void 0==t.opts.groupIndex?t.opts.options.groupIndex:t.opts.groupIndex,e},t.prototype.removeTiles=function(t,e,i){var o=$(i).find(".pip-draggable-tile");_.each(e,function(e){t.tiles.splice(e,1),o[e].remove()}),this.reIndexTiles(i)},t.prototype.reIndexTiles=function(t,e){var i=$(t).find(".pip-draggable-tile"),o=void 0===e?t.attributes["data-group-id"].value:e;_.each(i,function(t,e){var i=$(t).children()[0];angular.element(i).scope().index=e,angular.element(i).scope().groupIndex=o})},t.prototype.removeGroups=function(t){var e=this,i=[],o=[],n=[];_.each(this.groups,function(e,n){_.findIndex(t,function(t){return t.title===e.title})<0?i.push(n):o.push(n)}),_.each(i.reverse(),function(t){e.groups.splice(t,1),e.tileGroups.splice(t,1)}),_.each(o,function(t){n.push(e.groupsContainers[t])}),this.groupsContainers=n,_.each(this.groupsContainers,function(t,i){e.reIndexTiles(t,i)})},t.prototype.addGroup=function(t){var e=this,i={title:t.title,source:t.source.map(function(t){var i=e.createTileScope(t);return o.IDragTileConstructor(o.DragTileService,{tpl:e.$compile(t.template)(i),options:t.opts,size:t.opts.size})})};this.groups.push(i),this.$scope.$$phase||this.$scope.$apply(),this.$timeout(function(){e.groupsContainers=document.querySelectorAll(e.opts.groupContaninerSelector),e.tileGroups.push(n.ITilesGridConstructor(n.TilesGridService,i.source,e.opts,e.availableColumns,e.groupsContainers[e.groupsContainers.length-1]).generateGrid(e.getSingleTileWidthForMobile(e.availableWidth)).setTilesDimensions().calcContainerHeight())}),this.updateTilesTemplates("addGroup",t)},t.prototype.addTilesIntoGroup=function(t,e,i){var n=this;t.forEach(function(t){var l=n.createTileScope(t),r=o.IDragTileConstructor(o.DragTileService,{tpl:n.$compile(t.template)(l),options:t.opts,size:t.opts.size});e.addTile(r),$("<div>").addClass("pip-draggable-tile").append(r.getCompiledTemplate()).appendTo(i)})},t.prototype.updateTilesOptions=function(t){var e=this;t.forEach(function(t){t.source.forEach(function(t){e.tileGroups.forEach(function(e){e.updateTileOptions(t.opts)})})})},t.prototype.initTilesGroups=function(t,e,i){var o=this;return t.map(function(t,l){return n.ITilesGridConstructor(n.TilesGridService,t.source,e,o.availableColumns,i[l]).generateGrid(o.getSingleTileWidthForMobile(o.availableWidth)).setTilesDimensions().calcContainerHeight()})},t.prototype.updateTilesGroups=function(t,e){var i=this;this.tileGroups.forEach(function(o){t||o.generateGrid(i.getSingleTileWidthForMobile(i.availableWidth)),o.setTilesDimensions(t,e).calcContainerHeight()})},t.prototype.getContainerWidth=function(){var t=this.$container||$("body");return t.width()},t.prototype.getAvailableColumns=function(t){return this.opts.mobileBreakpoint>t?l:Math.floor(t/(this.opts.tileWidth+this.opts.gutter))},t.prototype.getActiveGroupAndTile=function(t){var e={};return this.tileGroups.forEach(function(i){var o=i.getTileByNode(t);if(o)return e.group=i,void(e.tile=o)}),e},t.prototype.getSingleTileWidthForMobile=function(t){return this.opts.mobileBreakpoint>t?t/2-this.opts.gutter:null},t.prototype.onDragStartListener=function(t){var e=this.getActiveGroupAndTile(t.target);this.container=$(t.target).parent(".pip-draggable-group").get(0),this.draggedTile=e.tile,this.activeDraggedGroup=e.group,this.$element.addClass("drag-transfer"),this.draggedTile.startDrag()},t.prototype.onDragMoveListener=function(t){var e=this,i=t.target,o=(parseFloat(i.style.left)||0)+t.dx,n=(parseFloat(i.style.top)||0)+t.dy;this.containerOffset=this.getContainerOffset(),i.style.left=o+"px",i.style.top=n+"px";var l=this.activeDraggedGroup.getTileByCoordinates({left:t.pageX-this.containerOffset.left,top:t.pageY-this.containerOffset.top},this.draggedTile);if(l){var r=this.activeDraggedGroup.getTileIndex(this.draggedTile),s=this.activeDraggedGroup.getTileIndex(l);if(r+1===s)return;this.activeDraggedGroup.swapTiles(this.draggedTile,l).setTilesDimensions(!0,this.draggedTile),this.$timeout(function(){e.setGroupContainersHeight()},0)}},t.prototype.onDragEndListener=function(){this.draggedTile.stopDrag(this.isSameDropzone),this.$element.removeClass("drag-transfer"),this.activeDraggedGroup=null,this.draggedTile=null},t.prototype.getContainerOffset=function(){var t=this.container.getBoundingClientRect();return{left:t.left,top:t.top}},t.prototype.setGroupContainersHeight=function(){this.tileGroups.forEach(function(t){t.calcContainerHeight()})},t.prototype.moveTile=function(t,e,i){var o,n=t.removeTile(i),l=this.createTileScope(i);$(this.groupsContainers[_.findIndex(this.tileGroups,t)]).find(n.getElem()).remove(),null!==e&&(e.addTile(n),o=this.$compile(n.getElem())(l),$(this.groupsContainers[_.findIndex(this.tileGroups,e)]).append(o),this.$timeout(e.setTilesDimensions.bind(e,!0))),this.updateTilesTemplates("moveTile",{from:t,to:e,tile:n})},t.prototype.onDropListener=function(t){var e=t.target.attributes["data-group-id"].value,i=this.tileGroups[e];this.activeDraggedGroup!==i&&this.moveTile(this.activeDraggedGroup,i,this.draggedTile),this.updateTilesGroups(!0),this.sourceDropZoneElem=null},t.prototype.onDropToFictGroupListener=function(t){var e=this,i=this.activeDraggedGroup,o=this.draggedTile;this.addGroup({title:"New group",source:[]}),this.$timeout(function(){e.moveTile(i,e.tileGroups[e.tileGroups.length-1],o),e.updateTilesGroups(!0)}),this.sourceDropZoneElem=null},t.prototype.onDropEnterListener=function(t){this.sourceDropZoneElem||(this.sourceDropZoneElem=t.dragEvent.dragEnter),this.sourceDropZoneElem!==t.dragEvent.dragEnter?(t.dragEvent.dragEnter.classList.add("dropzone-active"),$("body").css("cursor","copy"),this.isSameDropzone=!1):($("body").css("cursor",""),this.isSameDropzone=!0)},t.prototype.onDropDeactivateListener=function(t){this.sourceDropZoneElem!==t.target&&(t.target.classList.remove(this.opts.activeDropzoneClass),$("body").css("cursor",""))},t.prototype.onDropLeaveListener=function(t){t.target.classList.remove(this.opts.activeDropzoneClass)},t.prototype.initialize=function(){var t=this;this.$timeout(function(){t.availableWidth=t.getContainerWidth(),t.availableColumns=t.getAvailableColumns(t.availableWidth),t.groupsContainers=document.querySelectorAll(t.opts.groupContaninerSelector),t.tileGroups=t.initTilesGroups(t.groups,t.opts,t.groupsContainers),interact(".pip-draggable-tile").draggable({autoScroll:{enabled:!0,container:$("#content").get(0),speed:500},onstart:function(e){t.onDragStartListener(e)},onmove:function(e){t.onDragMoveListener(e)},onend:function(e){t.onDragEndListener()}}),interact(".pip-draggable-group.fict-group").dropzone({ondrop:function(e){t.onDropToFictGroupListener(e)},ondragenter:function(e){t.onDropEnterListener(e)},ondropdeactivate:function(e){t.onDropDeactivateListener(e)},ondragleave:function(e){t.onDropLeaveListener(e)}}),interact(".pip-draggable-group").dropzone({ondrop:function(e){t.onDropListener(e)},ondragenter:function(e){t.onDropEnterListener(e)},ondropdeactivate:function(e){t.onDropDeactivateListener(e)},ondragleave:function(e){t.onDropLeaveListener(e)}}),t.$container.on("mousedown touchstart","md-menu .md-icon-button",function(){interact(".pip-draggable-tile").draggable(!1),$(t).trigger("click")}).on("mouseup touchend",function(){interact(".pip-draggable-tile").draggable(!0)})},0)},t}(),a={bindings:{tilesTemplates:"=pipTilesTemplates",tilesContext:"=pipTilesContext",options:"=pipDraggableGrid",groupMenuActions:"=pipGroupMenuActions"},templateUrl:"draggable/Draggable.html",controller:s};angular.module("pipDraggableTiles").component("pipDraggableGrid",a)},{"../tile_group/TileGroupService":24,"./DraggableTileService":12}],12:[function(t,e,i){"use strict";function o(t,e){return new t(e)}Object.defineProperty(i,"__esModule",{value:!0}),i.IDragTileConstructor=o;var n={colSpan:1,rowSpan:1},l=function(){function t(t){this.tpl=t.tpl.get(0),this.opts=t,this.size=_.merge({},n,t.size),this.elem=null}return t.prototype.getSize=function(){return this.size},t.prototype.setSize=function(t,e){return this.size.width=t,this.size.height=e,this.elem&&this.elem.css({width:t,height:e}),this},t.prototype.setPosition=function(t,e){return this.size.left=t,this.size.top=e,this.elem&&this.elem.css({left:t,top:e}),this},t.prototype.getCompiledTemplate=function(){return this.tpl},t.prototype.updateElem=function(t){return this.elem=$(this.tpl).parent(t),this},t.prototype.getElem=function(){return this.elem.get(0)},t.prototype.startDrag=function(){return this.preview=$("<div>").addClass("pip-dragged-preview").css({position:"absolute",left:this.elem.css("left"),top:this.elem.css("top"),width:this.elem.css("width"),height:this.elem.css("height")}),this.elem.addClass("no-animation").css({zIndex:"9999"}).after(this.preview),this},t.prototype.stopDrag=function(t){function e(){i.preview&&(i.preview.remove(),i.preview=null),i.elem.css("zIndex","").off("transitionend",e)}var i=this;return t?this.elem.removeClass("no-animation").css({left:this.preview.css("left"),top:this.preview.css("top")}).on("transitionend",e):(i.elem.css({left:i.preview.css("left"),top:i.preview.css("top"),zIndex:""}).removeClass("no-animation"),i.preview.remove(),i.preview=null),this},t.prototype.setPreviewPosition=function(t){this.preview.css(t)},t.prototype.getOptions=function(){return this.opts.options},t.prototype.setOptions=function(t){return _.merge(this.opts.options,t),_.merge(this.size,t.size),this},t}();i.DragTileService=l,angular.module("pipDraggableTiles").service("pipDragTile",function(){return function(t){var e=new l(t);return e}})},{}],13:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipDraggableTiles",[]),t("./DraggableTileService"),t("./Draggable")},{"./Draggable":11,"./DraggableTileService":12}],14:[function(t,e,i){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=t("../menu_tile/MenuTileService"),l=function(t){function e(e,i,o,n){var l=t.call(this)||this;return l.$element=i,l.$timeout=o,l.pipTileConfigDialogService=n,l.opacity=.57,l.options&&l.options.menu&&(l.menu=_.union(l.menu,l.options.menu)),l.menu.push({title:"Configurate",click:function(){l.onConfigClick()}}),l.color=l.options.color||"gray",l.opacity=l.options.opacity||l.opacity,l.drawImage(),e.$watch(function(){return i.is(":visible")},function(t){l.drawImage()}),l}return o(e,t),e.prototype.drawImage=function(){var t=this;this.options.image&&this.$timeout(function(){t.onImageLoad(t.$element.find("img"))},500)},e.prototype.onConfigClick=function(){var t=this;this._oldOpacity=_.clone(this.opacity),this.pipTileConfigDialogService.show({dialogClass:"pip-calendar-config",locals:{color:this.color,size:this.options.size||{colSpan:1,rowSpan:1},date:this.options.date,title:this.options.title,text:this.options.text,opacity:this.opacity,onOpacitytest:function(e){t.opacity=e}},extensionUrl:"event_tile/ConfigDialogExtension.html"},function(e){t.changeSize(e.size),t.color=e.color,t.options.color=e.color,t.options.date=e.date,t.options.title=e.title,t.options.text=e.text,t.options.opacity=e.opacity},function(){t.opacity=t._oldOpacity})},e.prototype.onImageLoad=function(t){this.setImageMarginCSS(this.$element.parent(),t)},e.prototype.changeSize=function(t){var e=this;this.options.size.colSpan=t.sizeX,this.options.size.rowSpan=t.sizeY,this.options.image&&this.$timeout(function(){e.setImageMarginCSS(e.$element.parent(),e.$element.find("img"))},500)},e.prototype.setImageMarginCSS=function(t,e){var i=t.width?t.width():t.clientWidth,o=t.height?t.height():t.clientHeight,n=e[0].naturalWidth||e.width,l=e[0].naturalHeight||e.height,r=0,s={};n/i>l/o?(r=-((n/l*o-i)/2),s["margin-left"]=""+r+"px",s.height=""+o+"px",s.width=""+n*o/l+"px",s["margin-top"]=""):(r=-((l/n*i-o)/2),s["margin-top"]=""+r+"px",s.height=""+l*i/n+"px",s.width=""+i+"px",s["margin-left"]=""),e.css(s)},e}(n.MenuTileService),r={bindings:{options:"=pipOptions"},controller:l,templateUrl:"event_tile/EventTile.html"};angular.module("pipDashboard").component("pipEventTile",r)},{"../menu_tile/MenuTileService":17}],15:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),t("./tile_group/index"),t("./draggable"),t("./menu_tile"),t("./add_tile_dialog"),t("./config_tile_dialog"),angular.module("pipDashboard",["pipDraggableTiles","pipDraggableTilesGroup","pipMenuTile","pipConfigDashboardTileDialog","pipAddDashboardTileDialog","pipDashboard.Templates","pipLayout","pipLocations","pipDateTime","pipCharts","pipTranslate","pipControls","pipButtons"]),t("./utility/TileTemplateUtility"),t("./common_tile/Tile"),t("./calendar_tile/CalendarTile"),t("./event_tile/EventTile"),t("./note_tile/NoteTile"),t("./picture_slider_tile/PictureSliderTile"),t("./position_tile/PositionTile"),t("./statistics_tile/StatisticsTile"),t("./dashboard/Dashboard")},{"./add_tile_dialog":3,"./calendar_tile/CalendarTile":4,"./common_tile/Tile":5,"./config_tile_dialog":9,"./dashboard/Dashboard":10,"./draggable":13,"./event_tile/EventTile":14,"./menu_tile":18,"./note_tile/NoteTile":19,"./picture_slider_tile/PictureSliderTile":20,"./position_tile/PositionTile":21,"./statistics_tile/StatisticsTile":22,"./tile_group/index":25,"./utility/TileTemplateUtility":26}],16:[function(t,e,i){var o=function(){return{restrict:"EA",templateUrl:"menu_tile/MenuTile.html"}};angular.module("pipMenuTile").directive("pipTileMenu",o)},{}],17:[function(t,e,i){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=t("../common_tile/Tile"),l=function(t){function e(){"ngInject";var e=t.call(this)||this;return e.menu=[{title:"Change Size",action:angular.noop,submenu:[{title:"1 x 1",action:"changeSize",params:{sizeX:1,sizeY:1}},{title:"2 x 1",action:"changeSize",params:{sizeX:2,sizeY:1}},{title:"2 x 2",action:"changeSize",params:{sizeX:2,sizeY:2}}]}],e}return o(e,t),e.prototype.callAction=function(t,e,i){this[t]&&this[t].call(this,e),i.click&&i.click.call(i,e,this)},e.prototype.changeSize=function(t){this.options.size.colSpan=t.sizeX,this.options.size.rowSpan=t.sizeY},e}(n.DashboardTile);i.MenuTileService=l;var r=function(){function t(){}return t.prototype.$get=function(){"ngInject";return null==this._service&&(this._service=new l),this._service},t}();angular.module("pipMenuTile").provider("pipMenuTile",r)},{"../common_tile/Tile":5}],18:[function(t,e,i){"use strict";function o(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipMenuTile",[]),t("./MenuTileDirective"),t("./MenuTileService"),o(t("./MenuTileService"))},{"./MenuTileDirective":16,"./MenuTileService":17}],19:[function(t,e,i){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=t("../menu_tile/MenuTileService"),l=function(t){function e(e){var i=t.call(this)||this;return i.pipTileConfigDialogService=e,i.options&&(i.menu=i.options.menu?_.union(i.menu,i.options.menu):i.menu),i.menu.push({title:"Configurate",click:function(){i.onConfigClick()}}),i.color=i.options.color||"orange",i}return o(e,t),e.prototype.onConfigClick=function(){var t=this;this.pipTileConfigDialogService.show({locals:{color:this.color,size:this.options.size,title:this.options.title,text:this.options.text},extensionUrl:"note_tile/ConfigDialogExtension.html"},function(e){t.color=e.color,t.options.color=e.color,t.changeSize(e.size),t.options.text=e.text,t.options.title=e.title})},e}(n.MenuTileService),r={bindings:{options:"=pipOptions"},controller:l,templateUrl:"note_tile/NoteTile.html"};angular.module("pipDashboard").component("pipNoteTile",r)},{"../menu_tile/MenuTileService":17}],20:[function(t,e,i){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),
e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=t("../menu_tile/MenuTileService"),l=function(t){function e(e,i,o,n){var l=t.call(this)||this;return l.$scope=e,l.$element=i,l.$timeout=o,l.pipTileTemplate=n,l.animationType="fading",l.animationInterval=5e3,l.options&&(l.animationType=l.options.animationType||l.animationType,l.animationInterval=l.options.animationInterval||l.animationInterval),l}return o(e,t),e.prototype.onImageLoad=function(t){var e=this;this.$timeout(function(){e.pipTileTemplate.setImageMarginCSS(e.$element.parent(),t.target)})},e.prototype.changeSize=function(t){var e=this;this.options.size.colSpan=t.sizeX,this.options.size.rowSpan=t.sizeY,this.$timeout(function(){_.each(e.$element.find("img"),function(t){e.pipTileTemplate.setImageMarginCSS(e.$element.parent(),t)})},500)},e}(n.MenuTileService),r={bindings:{options:"=pipOptions"},controller:l,templateUrl:"picture_slider_tile/PictureSliderTile.html"};angular.module("pipDashboard").component("pipPictureSliderTile",r)},{"../menu_tile/MenuTileService":17}],21:[function(t,e,i){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=t("../menu_tile/MenuTileService"),l=function(t){function e(e,i,o,n,l){var r=t.call(this)||this;return r.$timeout=i,r.$element=o,r.pipTileConfigDialogService=n,r.pipLocationEditDialog=l,r.showPosition=!0,r.options&&r.options.menu&&(r.menu=_.union(r.menu,r.options.menu)),r.menu.push({title:"Configurate",click:function(){r.onConfigClick()}}),r.menu.push({title:"Change location",click:function(){r.openLocationEditDialog()}}),r.options.location=r.options.location||r.options.position,e.$watch("$ctrl.options.location",function(){r.reDrawPosition()}),e.$watch(function(){return o.is(":visible")},function(t){1==t&&r.reDrawPosition()}),r}return o(e,t),e.prototype.onConfigClick=function(){var t=this;this.pipTileConfigDialogService.show({dialogClass:"pip-position-config",locals:{size:this.options.size,locationName:this.options.locationName,hideColors:!0},extensionUrl:"position_tile/ConfigDialogExtension.html"},function(e){t.changeSize(e.size),t.options.locationName=e.locationName})},e.prototype.changeSize=function(t){this.options.size.colSpan=t.sizeX,this.options.size.rowSpan=t.sizeY,this.reDrawPosition()},e.prototype.openLocationEditDialog=function(){var t=this;this.pipLocationEditDialog.show({locationName:this.options.locationName,locationPos:this.options.location},function(e){e&&(t.options.location=e.location,t.options.locationName=e.locatioName)})},e.prototype.reDrawPosition=function(){var t=this;this.showPosition=!1,this.$timeout(function(){t.showPosition=!0},50)},e}(n.MenuTileService),r={bindings:{options:"=pipOptions"},controller:l,templateUrl:"position_tile/PositionTile.html"};angular.module("pipDashboard").component("pipPositionTile",r)},{"../menu_tile/MenuTileService":17}],22:[function(t,e,i){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(i,"__esModule",{value:!0});var n=t("../menu_tile/MenuTileService"),l=70,r=250,s=function(t){function e(e,i){var o=t.call(this)||this;return o.reset=!1,o.chartSize=l,o._$scope=e,o._$timeout=i,o.options&&(o.menu=o.options.menu?_.union(o.menu,o.options.menu):o.menu),o.setChartSize(),o}return o(e,t),e.prototype.changeSize=function(t){var e=this;this.options.size.colSpan=t.sizeX,this.options.size.rowSpan=t.sizeY,this.reset=!0,this.setChartSize(),this._$timeout(function(){e.reset=!1},500)},e.prototype.setChartSize=function(){this.chartSize=2==this.options.size.colSpan&&2==this.options.size.rowSpan?r:l},e}(n.MenuTileService),a={bindings:{options:"=pipOptions"},controller:s,templateUrl:"statistics_tile/StatisticsTile.html"};angular.module("pipDashboard").component("pipStatisticsTile",a)},{"../menu_tile/MenuTileService":17}],23:[function(t,e,i){function o(t,e,i){function o(t){return $("<div>").addClass("pip-draggable-tile").append(t).get(0)}var n=document.createDocumentFragment(),l=t.$eval(i.pipDraggableTiles);l.forEach(function(t){var e=o(t.getCompiledTemplate());n.appendChild(e)}),e.append(n)}function n(){return{restrict:"A",link:function(t,e,i){new o(t,e,i)}}}angular.module("pipDraggableTilesGroup").directive("pipDraggableTiles",n)},{}],24:[function(t,e,i){"use strict";function o(t,e,i,o,n){return new t(e,i,o,n)}Object.defineProperty(i,"__esModule",{value:!0}),i.ITilesGridConstructor=o;var n=2,l=function(){function t(t,e,i,o){this.gridCells=[],this.inline=!1,this.tiles=t,this.opts=e,this.columns=i||0,this.elem=o,this.gridCells=[],this.inline=e.inline||!1,this.isMobileLayout=i===n}return t.prototype.addTile=function(t){return this.tiles.push(t),1===this.tiles.length&&this.generateGrid(),this},t.prototype.getCellByPosition=function(t,e){return this.gridCells[t][e]},t.prototype.getCells=function(t,e,i){return this.isMobileLayout?this.getAvailableCellsMobile(t,e,i):this.getAvailableCellsDesktop(t,e,i)},t.prototype.getAvailableCellsDesktop=function(t,e,i){var o,n,l=t&&t.col||0,r=this.getBasicRow(t);if(1===i&&1===e){var s=this.gridCells.slice();if(t){if(o=this.getCell(s,r,l,this.columns),!o){var a=this.isMobileLayout?1:2;o=this.getCell(s,r+a,0,this.columns)}}else o=s[0][0]}if(2===i&&1===e){var p=t&&t.elem.size||null;p?2===p.colSpan&&2===p.rowSpan?this.columns-l-2>0?(o=this.getCellByPosition(r,l+1),n=this.getCellByPosition(r,l+2)):(o=this.getCellByPosition(r+2,0),n=this.getCellByPosition(r+2,1)):2===p.colSpan&&1===p.rowSpan?t.row%2===0?(o=this.getCellByPosition(r+1,l-1),n=this.getCellByPosition(r+1,l)):this.columns-l-3>=0?(o=this.getCellByPosition(r,l+1),n=this.getCellByPosition(r,l+2)):(o=this.getCellByPosition(r+2,0),n=this.getCellByPosition(r+2,1)):1===p.colSpan&&1===p.rowSpan&&(this.columns-l-3>=0?this.isCellFree(r,l+1)?(o=this.getCellByPosition(r,l+1),n=this.getCellByPosition(r,l+2)):(o=this.getCellByPosition(r,l+2),n=this.getCellByPosition(r,l+3)):(o=this.getCellByPosition(r+2,0),n=this.getCellByPosition(r+2,1))):(o=this.getCellByPosition(r,l),n=this.getCellByPosition(r,l+1))}return t||2!==e||2!==i?2===e&&2===i&&(this.columns-l-2>0?this.isCellFree(r,l+1)?(o=this.getCellByPosition(r,l+1),n=this.getCellByPosition(r+1,l+2)):(o=this.getCellByPosition(r,l+2),n=this.getCellByPosition(r+1,l+3)):(o=this.getCellByPosition(r+2,0),n=this.getCellByPosition(r+3,1))):(o=this.getCellByPosition(r,l),n=this.getCellByPosition(r+1,l+1)),{start:o,end:n}},t.prototype.getCell=function(t,e,i,o){var n,l,r;if(this.isMobileLayout){for(l=i;l<o;l++)if(!t[e][l].elem){n=t[e][l];break}return n}for(l=i;l<o;l++){for(r=0;r<2;r++)if(!t[r+e][l].elem){n=t[r+e][l];break}if(n)return n}},t.prototype.getAvailableCellsMobile=function(t,e,i){var o,n,l=this.getBasicRow(t),r=t&&t.col||0;if(1===i&&1===e){var s=this.gridCells.slice();if(t){if(o=this.getCell(s,l,r,this.columns),!o){var a=this.isMobileLayout?1:2;o=this.getCell(s,l+a,0,this.columns)}}else o=s[0][0]}return t?2===i&&(o=this.getCellByPosition(l+1,0),n=this.getCellByPosition(l+e,1)):(o=this.getCellByPosition(l,0),n=this.getCellByPosition(l+e-1,1)),{start:o,end:n}},t.prototype.getBasicRow=function(t){var e;return e=this.isMobileLayout?t?t&&t.row||0:0:t?t.row%2===0?t.row:t.row-1:0},t.prototype.isCellFree=function(t,e){return!this.gridCells[t][e].elem},t.prototype.getCellIndex=function(t){var e,i=this;return this.gridCells.forEach(function(o,n){e=_.findIndex(i.gridCells[n],function(e){return e===t}),e!==-1}),e!==-1?e:0},t.prototype.reserveCells=function(t,e,i){this.gridCells.forEach(function(o){o.forEach(function(o){o.row>=t.row&&o.row<=e.row&&o.col>=t.col&&o.col<=e.col&&(o.elem=i)})})},t.prototype.clearElements=function(){this.gridCells.forEach(function(t){t.forEach(function(t){t.elem=null})})},t.prototype.setAvailableColumns=function(t){return this.isMobileLayout=t===n,this.columns=t,this},t.prototype.generateGrid=function(t){function e(t){Array.apply(null,Array(t)).forEach(function(){i.columns<l+1&&(r++,l=0,i.gridCells.push(s),s=[]);var t=r*i.opts.tileHeight+(r?r*i.opts.gutter:0)+n.height,e=l*o+(l?l*i.opts.gutter:0);s.push({top:t,left:e,bottom:t+i.opts.tileHeight,right:e+o,row:r,col:l}),l++})}var i=this,o=t||this.opts.tileWidth,n=document.querySelector(".pip-draggable-group-title").getBoundingClientRect(),l=0,r=0,s=[];return this.gridCells=[],this.tiles.forEach(function(t,o,n){var r=t.getSize();e(r.colSpan),n.length===o+1&&(l<i.columns&&e(i.columns-l),2*i.tiles.length>i.gridCells.length&&Array.apply(null,Array(2*i.tiles.length-i.gridCells.length)).forEach(function(){e(i.columns)}))}),this},t.prototype.setTilesDimensions=function(t,e){var i,o=this,n=0;return t&&o.clearElements(),this.tiles.forEach(function(l){var r,s,a,p,c=l.getSize();return l.updateElem(".pip-draggable-tile"),1===c.colSpan?(r=i&&2===i.elem.size.colSpan&&1===i.elem.size.rowSpan?o.getCells(o.getCellByPosition(i.row,i.col-1),1,1).start:o.getCells(i,1,1).start,t||(s=r.right-r.left,a=r.bottom-r.top),i=r,o.reserveCells(r,r,l),n++):2===c.colSpan&&(p=o.getCells(i,c.rowSpan,c.colSpan),r=p.start,t||(s=p.end.right-p.start.left,a=p.end.bottom-p.start.top),i=p.end,o.reserveCells(p.start,p.end,l),n+=2),e===l?void l.setPreviewPosition({left:r.left,top:r.top}):(t||l.setSize(s,a),void l.setPosition(r.left,r.top))}),this},t.prototype.calcContainerHeight=function(){var t,e;return this.tiles.length?(t=_.maxBy(this.tiles,function(t){var e=t.getSize();return e.top+e.height}).getSize(),this.elem.style.height=t.top+t.height+"px",this.inline&&(e=_.maxBy(this.tiles,function(t){var e=t.getSize();return e.left+e.width}).getSize(),this.elem.style.width=e.left+e.width+"px"),this):this},t.prototype.getTileByNode=function(t){var e=this.tiles.filter(function(e){return t===e.getElem()});return e.length?e[0]:null},t.prototype.getTileByCoordinates=function(t,e){return this.tiles.filter(function(i){var o=i.getSize();return i!==e&&o.left<=t.left&&t.left<=o.left+o.width&&o.top<=t.top&&t.top<=o.top+o.height})[0]||null},t.prototype.getTileIndex=function(t){return _.findIndex(this.tiles,t)},t.prototype.swapTiles=function(t,e){var i=_.findIndex(this.tiles,t),o=_.findIndex(this.tiles,e);return this.tiles.splice(i,1),this.tiles.splice(o,0,t),this},t.prototype.removeTile=function(t){var e;return this.tiles.forEach(function(i,o,n){if(i===t)return e=n.splice(o,1)[0],!1}),e},t.prototype.updateTileOptions=function(t){var e=_.findIndex(this.tiles,function(e){return e.getOptions()===t});return e!==-1&&(this.tiles[e].setOptions(t),!0)},t}();i.TilesGridService=l,angular.module("pipDraggableTilesGroup").service("pipTilesGrid",function(){return function(t,e,i,o){var n=new l(t,e,i,o);return n}})},{}],25:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipDraggableTilesGroup",[]),t("./TileGroupDirective"),t("./TileGroupService")},{"./TileGroupDirective":23,"./TileGroupService":24}],26:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e,i){this._$interpolate=t,this._$compile=e,this._$templateRequest=i}return t.$inject=["$interpolate","$compile","$templateRequest"],t.prototype.getTemplate=function(t,e,i,o){var n,l=this,r=t.template,s=t.templateUrl,a=t.type;if(a){var p=e?this._$interpolate(e)(t):this._$interpolate(r)(t);return 1==o?i?this._$compile(p)(i):this._$compile(p):p}return r?i?this._$compile(r)(i):this._$compile(r):(s&&this._$templateRequest(s,!1).then(function(t){n=i?l._$compile(t)(i):l._$compile(t)}),n)},t.prototype.setImageMarginCSS=function(t,e){var i=t.width?t.width():t.clientWidth,o=t.height?t.height():t.clientHeight,n=(e[0]?e[0].naturalWidth:e.naturalWidth)||e.width,l=(e[0]?e[0].naturalHeight:e.naturalWidth)||e.height,r=0,s={};n/i>l/o?(r=-((n/l*o-i)/2),s["margin-left"]=""+r+"px",s.height=""+o+"px",s.width=""+n*o/l+"px",s["margin-top"]=""):(r=-((l/n*i-o)/2),s["margin-top"]=""+r+"px",s.height=""+l*i/n+"px",s.width=""+i+"px",s["margin-left"]=""),$(e).css(s)},t}(),n=function(t){return{restrict:"A",link:function(e,i,o){var n=t(o.pipImageLoad);i.bind("load",function(t){n(e,{$event:t})})}}};n.$inject=["$parse"],angular.module("pipDashboard").service("pipTileTemplate",o).directive("pipImageLoad",n)},{}],27:[function(t,e,i){!function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("add_tile_dialog/AddTile.html",'<md-dialog class="pip-dialog pip-add-component-dialog"><md-dialog-content class="layout-column"><div class="theme-divider p16 flex-auto"><h3 class="hide-xs m0 bm16 theme-text-primary" hide-xs="">{{ \'DASHBOARD_ADD_TILE_DIALOG_TITLE\' | translate }}<md-input-container class="layout-row flex-auto m0 tm16"><md-select class="flex-auto m0 theme-text-primary" ng-model="dialogCtrl.activeGroupIndex" placeholder="{{ \'DASHBOARD_ADD_TILE_DIALOG_CREATE_NEW_GROUP\' | translate }}" aria-label="Group"><md-option ng-value="$index" ng-repeat="group in dialogCtrl.groups">{{ group }}</md-option></md-select></md-input-container></h3></div><div class="pip-body pip-scroll p0 flex-auto"><p class="md-body-1 theme-text-secondary m0 lp16 rp16">{{ \'DASHBOARD_ADD_TILE_DIALOG_USE_HOT_KEYS\' | translate }}</p><md-list ng-init="groupIndex = $index" ng-repeat="group in dialogCtrl.defaultWidgets"><md-list-item class="layout-row pip-list-item lp16 rp16" ng-repeat="item in group"><div class="icon-holder flex-none"><md-icon md-svg-icon="icons:{{:: item.icon }}"></md-icon><div class="pip-badge theme-badge md-warn" ng-if="item.amount"><span>{{ item.amount }}</span></div></div><span class="flex-auto lm24 theme-text-primary">{{:: item.title }}</span><md-button class="md-icon-button flex-none" ng-click="dialogCtrl.encrease(groupIndex, $index)" aria-label="Encrease"><md-icon md-svg-icon="icons:plus-circle"></md-icon></md-button><md-button class="md-icon-button flex-none" ng-click="dialogCtrl.decrease(groupIndex, $index)" aria-label="Decrease"><md-icon md-svg-icon="icons:minus-circle"></md-icon></md-button></md-list-item><md-divider class="lm72 tm8 bm8" ng-if="groupIndex !== (dialogCtrl.defaultWidgets.length - 1)"></md-divider></md-list></div></md-dialog-content><md-dialog-actions class="flex-none layout-align-end-center theme-divider divider-top theme-text-primary"><md-button ng-click="dialogCtrl.cancel()" aria-label="Cancel">{{ \'CANCEL\' | translate }}</md-button><md-button ng-click="dialogCtrl.add()" ng-disabled="dialogCtrl.totalWidgets === 0" arial-label="Add">{{ \'ADD\' | translate }}</md-button></md-dialog-actions></md-dialog>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("calendar_tile/CalendarTile.html",'<div class="widget-box pip-calendar-widget {{ $ctrl.color }} layout-column layout-fill tp0" ng-class="{ small: $ctrl.options.size.colSpan == 1 && $ctrl.options.size.rowSpan == 1, medium: $ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 1, big: $ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 2 }"><div class="widget-heading layout-row layout-align-end-center flex-none"><pip-tile-menu></pip-tile-menu></div><div class="widget-content flex-auto layout-row layout-align-center-center" ng-if="$ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 1"><span class="date lm24 rm12">{{ $ctrl.options.date.getDate() }}</span><div class="flex-auto layout-column"><span class="weekday md-headline">{{ $ctrl.options.date | formatLongDayOfWeek }}</span> <span class="month-year md-headline">{{ $ctrl.options.date | formatLongMonth }} {{ $ctrl.options.date | formatYear }}</span></div></div><div class="widget-content flex-auto layout-column layout-align-space-around-center" ng-hide="$ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 1"><span class="weekday md-headline" ng-hide="$ctrl.options.size.colSpan == 1 && $ctrl.options.size.rowSpan == 1">{{ $ctrl.options.date | formatLongDayOfWeek }}</span> <span class="weekday" ng-show="$ctrl.options.size.colSpan == 1 && $ctrl.options.size.rowSpan == 1">{{ $ctrl.options.date | formatLongDayOfWeek }}</span> <span class="date lm12 rm12">{{ $ctrl.options.date.getDate() }}</span> <span class="month-year md-headline">{{ $ctrl.options.date | formatLongMonth }} {{ $ctrl.options.date | formatYear }}</span></div></div>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("calendar_tile/ConfigDialogExtension.html",'<div class="w-stretch bm16">Date:<md-datepicker ng-model="$ctrl.date" class="w-stretch"></md-datepicker></div>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("config_tile_dialog/ConfigDialog.html",'<md-dialog class="pip-dialog pip-tile-config-dialog {{ vm.params.dialogClass }}" width="400" md-theme="{{vm.theme}}"><pip-tile-config-extend-component class="layout-column" pip-dialog-scope="vm" pip-extension-url="vm.extensionUrl" pip-apply="vm.onApply(updatedData)"></pip-tile-config-extend-component></md-dialog>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("config_tile_dialog/ConfigDialogExtendComponent.html",'<h3 class="tm0 flex-none">{{ \'DASHBOARD_TILE_CONFIG_DIALOG_TITLE\' | translate }}</h3><div class="pip-body pip-scroll p16 bp0 flex-auto"><pip-extension-point></pip-extension-point><pip-toggle-buttons class="bm16" ng-if="!$ctrl.hideSizes" pip-buttons="$ctrl.sizes" ng-model="$ctrl.sizeId"></pip-toggle-buttons><pip-color-picker ng-if="!$ctrl.hideColors" pip-colors="$ctrl.colors" ng-model="$ctrl.color"></pip-color-picker></div><div class="pip-footer flex-none"><div><md-button class="md-accent" ng-click="$ctrl.onCancel()">{{ \'CANCEL\' | translate }}</md-button><md-button class="md-accent" ng-click="$ctrl.onApply()">{{ \'APPLY\' | translate }}</md-button></div></div>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("dashboard/Dashboard.html",'<md-button class="md-accent md-raised md-fab layout-column layout-align-center-center" aria-label="Add component" ng-click="$ctrl.addComponent()"><md-icon md-svg-icon="icons:plus" class="md-headline centered-add-icon"></md-icon></md-button><div class="pip-draggable-grid-holder"><pip-draggable-grid pip-tiles-templates="$ctrl.groupedWidgets" pip-tiles-context="$ctrl.widgetsContext" pip-draggable-grid="$ctrl.draggableGridOptions" pip-group-menu-actions="$ctrl.groupMenuActions"></pip-draggable-grid><md-progress-circular md-mode="indeterminate" class="progress-ring"></md-progress-circular></div>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("draggable/Draggable.html",'<div class="pip-draggable-holder"><div class="pip-draggable-group" ng-repeat="group in $ctrl.groups" data-group-id="{{ $index }}" pip-draggable-tiles="group.source"><div class="pip-draggable-group-title layout-row layout-align-start-center"><div class="title-input-container" ng-click="$ctrl.onTitleClick(group, $event)"><input ng-if="group.editingName" ng-blur="$ctrl.onBlurTitleInput(group)" ng-keypress="$ctrl.onKyepressTitleInput(group, $event)" ng-model="group.title"><div class="text-overflow flex-none" ng-if="!group.editingName">{{ group.title }}</div></div><md-button class="md-icon-button flex-none layout-align-center-center" ng-show="group.editingName" ng-click="$ctrl.cancelEditing(group)" aria-label="Cancel"><md-icon md-svg-icon="icons:cross"></md-icon></md-button><md-menu class="flex-none layout-column" md-position-mode="target-right target" ng-show="!group.editingName"><md-button class="md-icon-button flex-none layout-align-center-center" ng-click="$mdOpenMenu(); groupId = $index" aria-label="Menu"><md-icon md-svg-icon="icons:dots"></md-icon></md-button><md-menu-content width="4"><md-menu-item ng-repeat="action in $ctrl.groupMenuActions"><md-button ng-click="action.callback(groupId)">{{ action.title }}</md-button></md-menu-item></md-menu-content></md-menu></div></div><div class="pip-draggable-group fict-group layout-align-center-center layout-column tm16"><div class="fict-group-text-container"><md-icon md-svg-icon="icons:plus"></md-icon>{{ \'DROP_TO_CREATE_NEW_GROUP\' | translate }}</div></div></div>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("event_tile/ConfigDialogExtension.html",'<div class="w-stretch"><md-input-container class="w-stretch bm0"><label>Title:</label> <input type="text" ng-model="$ctrl.title"></md-input-container>Date:<md-datepicker ng-model="$ctrl.date" class="w-stretch bm8"></md-datepicker><md-input-container class="w-stretch"><label>Description:</label> <textarea type="text" ng-model="$ctrl.text">\n    </textarea></md-input-container>Backdrop\'s opacity:<md-slider aria-label="opacity" type="number" min="0.1" max="0.9" step="0.01" ng-model="$ctrl.opacity" ng-change="$ctrl.onOpacitytest($ctrl.opacity)"></md-slider></div>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("event_tile/EventTile.html",'<div class="widget-box pip-event-widget {{ $ctrl.color }} layout-column layout-fill" ng-class="{ small: $ctrl.options.size.colSpan == 1 && $ctrl.options.size.rowSpan == 1, medium: $ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 1, big: $ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 2 }"><img ng-if="$ctrl.options.image" ng-src="{{$ctrl.options.image}}" alt="{{$ctrl.options.title || $ctrl.options.name}}"><div class="text-backdrop" style="background-color: rgba(0, 0, 0, {{ $ctrl.opacity }})"><div class="widget-heading layout-row layout-align-start-center flex-none"><span class="widget-title flex-auto text-overflow">{{ $ctrl.options.title || $ctrl.options.name }}</span><pip-tile-menu ng-if="!$ctrl.options.hideMenu"></pip-tile-menu></div><div class="text-container flex-auto pip-scroll"><p class="date flex-none" ng-if="$ctrl.options.date">{{ $ctrl.options.date | formatShortDate }}</p><p class="text flex-auto">{{ $ctrl.options.text || $ctrl.options.description }}</p></div></div></div>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("menu_tile/MenuTile.html",'<md-menu class="widget-menu" md-position-mode="target-right target"><md-button class="md-icon-button flex-none" ng-click="$mdOpenMenu()" aria-label="Menu"><md-icon md-svg-icon="icons:vdots"></md-icon></md-button><md-menu-content width="4"><md-menu-item ng-repeat="item in $ctrl.menu"><md-button ng-if="!item.submenu" ng-click="$ctrl.callAction(item.action, item.params, item)">{{:: item.title }}</md-button><md-menu ng-if="item.submenu"><md-button ng-click="$ctrl.callAction(item.action)">{{:: item.title }}</md-button><md-menu-content><md-menu-item ng-repeat="subitem in item.submenu"><md-button ng-click="$ctrl.callAction(subitem.action, subitem.params, subitem)">{{:: subitem.title }}</md-button></md-menu-item></md-menu-content></md-menu></md-menu-item></md-menu-content></md-menu>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("note_tile/ConfigDialogExtension.html",'<div class="w-stretch"><md-input-container class="w-stretch bm0"><label>Title:</label> <input type="text" ng-model="$ctrl.title"></md-input-container><md-input-container class="w-stretch tm0"><label>Text:</label> <textarea type="text" ng-model="$ctrl.text">\n    </textarea></md-input-container></div>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("note_tile/NoteTile.html",'<div class="widget-box pip-notes-widget {{ $ctrl.color }} layout-column"><div class="widget-heading layout-row layout-align-start-center flex-none" ng-if="$ctrl.options.title || $ctrl.options.name"><span class="widget-title flex-auto text-overflow">{{ $ctrl.options.title || $ctrl.options.name }}</span></div><pip-tile-menu ng-if="!$ctrl.options.hideMenu"></pip-tile-menu><div class="text-container flex-auto pip-scroll"><p>{{ $ctrl.options.text }}</p></div></div>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("picture_slider_tile/PictureSliderTile.html",'<div class="widget-box pip-picture-slider-widget {{ $ctrl.color }} layout-column layout-fill" ng-class="{ small: $ctrl.options.size.colSpan == 1 && $ctrl.options.size.rowSpan == 1, medium: $ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 1, big: $ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 2 }" index="{{ $ctrl.index }}" group="{{ $ctrl.group }}"><div class="widget-heading lp16 rp8 layout-row layout-align-end-center flex-none"><span class="flex text-overflow">{{ $ctrl.options.title }}</span><pip-tile-menu ng-if="!$ctrl.options.hideMenu"></pip-tile-menu></div><div class="slider-container"><div pip-image-slider="" pip-animation-type="\'fading\'" pip-animation-interval="$ctrl.animationInterval" ng-if="$ctrl.animationType == \'fading\'"><div class="pip-animation-block" ng-repeat="slide in $ctrl.options.slides"><img ng-src="{{ slide.image }}" alt="{{ slide.image }}" pip-image-load="$ctrl.onImageLoad($event)"><p class="slide-text" ng-if="slide.text">{{ slide.text }}</p></div></div><div pip-image-slider="" pip-animation-type="\'carousel\'" pip-animation-interval="$ctrl.animationInterval" ng-if="$ctrl.animationType == \'carousel\'"><div class="pip-animation-block" ng-repeat="slide in $ctrl.options.slides"><img ng-src="{{ slide.image }}" alt="{{ slide.image }}" pip-image-load="$ctrl.onImageLoad($event)"><p class="slide-text" ng-if="slide.text">{{ slide.text }}</p></div></div></div></div>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("position_tile/ConfigDialogExtension.html",'<div class="w-stretch"><md-input-container class="w-stretch bm0"><label>Location name:</label> <input type="text" ng-model="$ctrl.locationName"></md-input-container></div>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("position_tile/PositionTile.html",'<div class="pip-position-widget widget-box p0 layout-column layout-fill" ng-class="{ small: $ctrl.options.size.colSpan == 1 && $ctrl.options.size.rowSpan == 1, medium: $ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 1, big: $ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 2 }" index="{{ $ctrl.index }}" group="{{ $ctrl.group }}"><div class="position-absolute-right-top" ng-if="!$ctrl.options.locationName"><pip-tile-menu ng-if="!$ctrl.options.hideMenu"></pip-tile-menu></div><div class="widget-heading lp16 rp8 layout-row layout-align-end-center flex-none" ng-if="$ctrl.options.locationName"><span class="flex text-overflow">{{ $ctrl.options.locationName }}</span><pip-tile-menu ng-if="!$ctrl.options.hideMenu"></pip-tile-menu></div><pip-location-map class="flex" ng-if="$ctrl.showPosition" pip-stretch="true" pip-rebind="true" pip-location-pos="$ctrl.options.location"></pip-location-map></div>')}])}(),function(t){try{t=angular.module("pipDashboard.Templates")}catch(e){t=angular.module("pipDashboard.Templates",[])}t.run(["$templateCache",function(t){t.put("statistics_tile/StatisticsTile.html",'<div class="widget-box pip-statistics-widget layout-column layout-fill" ng-class="{ small: $ctrl.options.size.colSpan == 1 && $ctrl.options.size.rowSpan == 1, medium: $ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 1, big: $ctrl.options.size.colSpan == 2 && $ctrl.options.size.rowSpan == 2 }"><div class="widget-heading layout-row layout-align-start-center flex-none"><span class="widget-title flex-auto text-overflow">{{ $ctrl.options.title || $ctrl.options.name }}</span><pip-tile-menu></pip-tile-menu></div><div class="widget-content flex-auto layout-row layout-align-center-center" ng-if="$ctrl.options.series && !$ctrl.reset"><pip-pie-chart pip-series="$ctrl.options.series" ng-if="!$ctrl.options.chartType || $ctrl.options.chartType == \'pie\'" pip-donut="true" pip-pie-size="$ctrl.chartSize" pip-show-total="true" pip-centered="true"></pip-pie-chart></div></div>')}])}()},{}]},{},[15,27])(27)});
//# sourceMappingURL=pip-webui-dashboard.min.js.map
